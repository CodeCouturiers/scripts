// ==UserScript==
// @name         Повний український переклад Taobao
// @namespace    http://tampermonkey.net/
// @version      1.1
// @description  Повний український переклад Taobao
// @author       Your name
// @match        *://*.taobao.com/*
// @grant        none
// @run-at       document-end
// ==/UserScript==

(function() {
    'use strict';
   const translations = {
    // Верхнє меню та навігація
    "请登录": "Увійти",
    "手机逛淘宝": "Мобільний додаток",
    "淘宝网首页": "Головна",
    "我的淘宝": "Особистий кабінет",
    "购物车": "Кошик",
    "收藏夹": "Вибране",
    "商品分类": "Категорії товарів",
    "免费开店": "Відкрити магазин",
    "联系客服": "Служба підтримки",
    "网站导航": "Навігація сайтом",
    "亲，请登录": "Будь ласка, увійдіть",

    // Особистий кабінет
    "我的足迹": "Історія переглядів",
    "已买到的宝贝": "Мої замовлення",
    "我的购物车": "Мій кошик",
    "购买过的店铺": "Історія покупок",
    "收藏的宝贝": "Вибрані товари",
    "收藏的店铺": "Вибрані магазини",
    "我的卡券包": "Мої купони",
    "我的发票": "Рахунки та чеки",
    "评价管理": "Мої відгуки",
    "账号设置": "Налаштування аккаунту",
    "安全设置": "Налаштування безпеки",
    "个人资料": "Особиста інформація",
    "账号绑定": "Прив'язка акаунту",
    "支付宝绑定": "Прив'язати Alipay",
    "所有订单": "Всі замовлення",
    "待付款": "Очікують оплати",
    "待发货": "Очікують відправки",
    "待收货": "Очікують отримання",
    "待评价": "Очікують відгуку",
    "分阶段": "Поетапно",
    "订单回收站": "Кошик замовлень",
    "再次购买": "Повторити замовлення",
    "订单号": "Номер замовлення",
    "我的收藏": "Мої вибрані",
    "我的拍卖": "Мої аукціони",
    "官方集运": "Офіційна доставка",
    "网页无障碍": "Доступність для всіх",
    "账号管理": "Управління акаунтом",
    "退出": "Вийти",
    "淘气值": "Бали Taobao",
    "普通会员": "Звичайний користувач",
    "查看你的专属权益": "Переглянути ваші привілеї",
    "修改头像、昵称": "Змінити аватар та нікнейм",
    "修改登录密码": "Змінити пароль",
    "手机绑定": "Прив'язати телефон",
    "密保问题设置": "Налаштування секретних питань",
    "其他": "Інше",
    "千牛卖家中心": "Центр продавця Qianniu",
    "开店入驻": "Реєстрація магазину",
    "已卖出的Товар": "Продані товари",
    "出售中的Товар": "Товари на продажу",
    "卖家服务": "Послуги для продавців",
    "市场": "Ринок",
    "卖家培训中心": "Навчальний центр для продавців",
    "体检中心": "Центр перевірки",
    "电商学习中心": "Центр e-commerce навчання",

    // Дії з товаром
    "商品操作": "Дії з товаром",

    // Товар
    "宝贝": "Товар",

    // Дії з замовленням
    "交易操作": "Дії з замовленням",

    // Статус замовлення
    "交易状态": "Статус замовлення",
    "等待买家付款": "Очікує оплати покупцем",
    "付款确认中": "Підтвердження оплати",
    "买家已付款": "Сплачено покупцем",

    // Статуси замовлень
    "交易成功": "Замовлення завершено",
    "等待付款": "Очікує оплати",
    "等待发货": "В обробці",
    "等待收货": "В доставці",
    "等待评价": "Очікує відгуку",
    "交易关闭": "Замовлення скасовано",
    "退款中": "Повернення",
    "交易异常": "Проблема із замовленням",
    "交易已关闭": "Замовлення закрито",

    // Деталі замовлення
    "订单详情": "Деталі замовлення",
    "收货地址": "Адреса доставки",
    "实付款": "Загальна сума",
    "运费": "Доставка",
    "优惠": "Знижка",
    "数量": "Кількість",
    "单价": "Ціна",
    "合计": "Разом",

    // Дії із замовленнями
    "申请售后": "Повернути товар",
    "查看详情": "Детальніше",
    "删除订单": "Видалити",
    "投诉卖家": "Поскаржитись",
    "确认收货": "Підтвердити отримання",
    "立即付款": "Оплатити",
    "追加评论": "Додати відгук",
    "取消订单": "Скасувати замовлення",
    "申请开票": "Запросити рахунок",
    "查看物流": "Відстежити",
    "双方已评": "Обидві сторони залишили відгук",
    "违规举报": "Повідомити про порушення",

    // Характеристики товару
    "颜色分类": "Колір",
    "尺码": "Розмір",
    "型号": "Модель",
    "规格": "Специфікація",
    "款式": "Стиль",
    "材质": "Матеріал",

    // Інформація про доставку
    "物流信息": "Інформація про доставку",
    "运单号": "Номер відстеження",
    "已发货": "Відправлено",
    "运输中": "У дорозі",
    "已签收": "Отримано",
    "暂无物流信息": "Немає інформації про доставку",

    // Повідомлення та сповіщення
    "消息": "Повідомлення",
    "系统通知": "Сповіщення",
    "交易物流": "Статус доставки",
    "商家通知": "Від продавця",
    "活动消息": "Акції",
    "全部消息": "Всі повідомлення",

    // Додаткові функції
    "退款维权": "Суперечки та повернення",
    "退款/退货": "Повернення грошей/товару",
    "投诉管理": "Скарги",
    "举报管理": "Порушення",
    "安全设置": "Безпека",
    "账户设置": "Налаштування профілю",
    "绑定手机": "Прив'язати телефон",
    "支付宝账户": "Аккаунт Alipay",
    "全部功能": "Всі функції",

    // Пошук та фільтри
    "搜索": "Пошук",
    "筛选": "Фільтр",
    "价格": "Ціна",
    "销量": "Продажі",
    "信用": "Рейтинг",
    "综合排序": "Сортування",

    // Кнопки дій
    "确定": "Підтвердити",
    "取消": "Скасувати",
    "保存": "Зберегти",
    "编辑": "Редагувати",
    "删除": "Видалити",
    "关闭": "Закрити",
    "提交": "Надіслати",

    // Футер та інше
    "帮助中心": "Центр допомоги",
    "联系我们": "Зв'язатися з нами",
    "意见反馈": "Зворотній зв'язок",
    "返回顶部": "Вгору",
    "首页": "Головна",
    "更多": "Більше"
};

    // Функція для безпечної заміни тексту без впливу на JS
    function safeTranslate(node) {
        if (node.nodeType === 3) { // Текстовий вузол
            let text = node.nodeValue;
            let translated = false;

            for (let [key, value] of Object.entries(translations)) {
                if (text.includes(key)) {
                    text = text.replace(new RegExp(key, 'g'), value);
                    translated = true;
                }
            }

            if (translated) {
                node.nodeValue = text;
            }
        } else if (node.nodeType === 1) { // Елемент
            // Пропускаємо скрипти та стилі
            if (node.nodeName !== 'SCRIPT' &&
                node.nodeName !== 'STYLE' &&
                !node.classList.contains('no-translate')) {

                // Перекладаємо title та placeholder якщо є
                if (node.hasAttribute('title')) {
                    let title = node.getAttribute('title');
                    for (let [key, value] of Object.entries(translations)) {
                        if (title.includes(key)) {
                            node.setAttribute('title', title.replace(key, value));
                        }
                    }
                }

                if (node.hasAttribute('placeholder')) {
                    let placeholder = node.getAttribute('placeholder');
                    for (let [key, value] of Object.entries(translations)) {
                        if (placeholder.includes(key)) {
                            node.setAttribute('placeholder', placeholder.replace(key, value));
                        }
                    }
                }

                // Рекурсивно обробляємо дочірні вузли
                Array.from(node.childNodes).forEach(safeTranslate);
            }
        }
    }

    // Функція для запуску перекладу
    function startTranslation() {
        safeTranslate(document.body);
    }

    // Спостерігач за змінами DOM
    const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
            if (mutation.addedNodes.length) {
                mutation.addedNodes.forEach((node) => {
                    if (node.nodeType === 1) {
                        safeTranslate(node);
                    }
                });
            }
        });
    });

    // Запускаємо спостерігач
    observer.observe(document.body, {
        childList: true,
        subtree: true
    });

    // Запускаємо початковий переклад
    startTranslation();

    // Періодично перевіряємо нові елементи
    setInterval(startTranslation, 2000);

})();
